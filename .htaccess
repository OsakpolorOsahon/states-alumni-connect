# Correct MIME types for JS, JSON, and other files
AddType application/javascript .js
AddType application/javascript .mjs
AddType text/javascript .js
AddType text/javascript .mjs
AddType application/json .json
AddType text/css .css
AddType image/png .png
AddType image/svg+xml .svg
AddType image/webp .webp

# Handle Vite build files
<Files "*.js">
  Header set Content-Type "application/javascript"
</Files>

<Files "*.mjs">
  Header set Content-Type "application/javascript"
</Files>

# Prevent script MIME errors
<IfModule mod_headers.c>
  Header set X-Content-Type-Options nosniff
  Header always set X-Frame-Options DENY
  Header always set X-Content-Type-Options nosniff
</IfModule>

# Enable compression for better performance
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Handle SPA routing - redirect all non-file requests to index.html
<IfModule mod_rewrite.c>
  RewriteEngine On
  
  # Handle Angular and React router
  # If an existing asset or directory is requested go to it as it is
  RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -f [OR]
  RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -d
  RewriteRule ^ - [L]
  
  # If the requested resource doesn't exist, use index.html
  RewriteRule ^ /index.html [L]
</IfModule>

# Redirect HTTP to HTTPS (optional but recommended)
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]